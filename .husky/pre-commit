#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üîç Running pre-commit checks..."

# Run lint-staged (linting and formatting)
echo "üìù Running lint-staged..."
npx lint-staged

# Run tests for staged files only
echo "üß™ Running tests..."
npm run test:staged

# Check for secrets in staged files
echo "üîí Checking for secrets..."
if command -v gitleaks >/dev/null 2>&1; then
    gitleaks protect --staged --verbose
else
    echo "‚ö†Ô∏è  gitleaks not installed, skipping secret detection"
    echo "   Install with: brew install gitleaks"
fi

echo "‚úÖ Pre-commit checks passed!"
